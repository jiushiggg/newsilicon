#include "delay.h"
#include <string.h>
#include "mini_fs.h"
#include "epd_choose.h"
#include "epd_io.h"
#include "sys_init.h"
#include "global_variable.h" 
#include "sys_isr.h"


#ifdef WF_420_BW_SINGLE
const char  G_Ultrachip0[] =
{
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf1,0xef,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xee,0xef,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xef,0x6f,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xef,0xaf,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf3,0xcf,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xe0,0x0f,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xf7,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xf7,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x7b,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xfb,0xbb,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0xdb,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0xeb,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0xf3,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xfe,0x0f,0xff,
  0xff,0xff,0xf8,0x3f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfd,0xf7,0xff,
  0xff,0xff,0xf7,0xdf,0xff,0xe7,0x3f,0xfc,0x00,0x00,0x00,0x00,0x01,0xfb,0xfb,0xff,
  0xff,0xff,0xef,0xef,0xff,0xc2,0x1f,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0xfb,0xff,
  0xff,0xff,0xef,0xef,0xff,0x98,0xcf,0xfc,0x00,0x00,0x00,0x00,0x01,0xfd,0xf7,0xff,
  0xff,0xff,0xf7,0xdf,0xff,0xbd,0xef,0xff,0xff,0xff,0xff,0xff,0xff,0xfe,0x0f,0xff,
  0xff,0xff,0xf8,0x3f,0xff,0xbd,0xef,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0x98,0xcf,0xfc,0x00,0x00,0x00,0x00,0x01,0xfe,0x0f,0xff,
  0xff,0xff,0xf0,0x3f,0xff,0xc2,0x1f,0xff,0xff,0xff,0xff,0xff,0xff,0xfd,0xf7,0xff,
  0xff,0xff,0xef,0x5f,0xff,0xe7,0x3f,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0xfb,0xff,
  0xff,0xff,0xef,0x6f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0xfb,0xff,
  0xff,0xff,0xef,0x6f,0xff,0xe0,0x3f,0xfc,0x00,0x00,0x00,0x00,0x01,0xfd,0xf7,0xff,
  0xff,0xff,0xf0,0xdf,0xff,0xc0,0x1f,0xfc,0x00,0x00,0x00,0x00,0x01,0xfe,0x0f,0xff,
  0xff,0xff,0xff,0xff,0xff,0x9f,0xcf,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xbf,0xef,0xfc,0x00,0x00,0x00,0x00,0x01,0xfe,0x0f,0xff,
  0xff,0xff,0xff,0xff,0xff,0xbf,0xef,0xff,0xff,0xff,0xff,0xff,0xff,0xfd,0xf7,0xff,
  0xff,0xff,0xff,0xff,0xff,0x9f,0xcf,0xfc,0x00,0x00,0x00,0x00,0x01,0xfb,0xfb,0xff,
  0xff,0xff,0xff,0xff,0xff,0xc0,0x1f,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0xfb,0xff,
  0xff,0xff,0xff,0xff,0xff,0xe0,0x3f,0xfc,0x00,0x00,0x00,0x00,0x01,0xfd,0xf7,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xfe,0x0f,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xfe,0x0f,0xff,
  0xff,0xff,0xf1,0x1f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfd,0xf7,0xff,
  0xff,0xff,0xee,0xef,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0xfb,0xff,
  0xff,0xff,0xee,0xef,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xfb,0xfb,0xff,
  0xff,0xff,0xee,0xef,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xfd,0xf7,0xff,
  0xff,0xff,0xf1,0x1f,0xff,0xff,0xef,0xfc,0x00,0x00,0x00,0x00,0x01,0xfe,0x0f,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xef,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xfb,0x87,0xff,
  0xff,0xff,0xe3,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xfb,0x7b,0xff,
  0xff,0xff,0xec,0x3f,0xff,0xe0,0x3f,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0x7b,0xff,
  0xff,0xff,0xef,0xcf,0xff,0xc0,0x1f,0xfc,0x00,0x00,0x00,0x00,0x01,0xfb,0x7b,0xff,
  0xff,0xff,0xef,0xff,0xff,0x9c,0xcf,0xff,0xff,0xff,0xff,0xff,0xff,0xf8,0x27,0xff,
  0xff,0xff,0xef,0xff,0xff,0xbe,0xef,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xef,0xff,0xff,0xbe,0xef,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0x80,0x8f,0xff,0xff,0xff,0xff,0xff,0xff,0xf8,0xff,0xff,
  0xff,0xff,0xf6,0x1f,0xff,0xc1,0x9f,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0x0f,0xff,
  0xff,0xff,0xed,0xef,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0xf3,0xff,
  0xff,0xff,0xed,0xef,0xff,0xe0,0x3f,0xfc,0x00,0x00,0x00,0x00,0x01,0xfb,0xff,0xff,
  0xff,0xff,0xf5,0xef,0xff,0xc0,0x1f,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0xff,0xff,
  0xff,0xff,0xf8,0x1f,0xff,0x9f,0xcf,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xbf,0xef,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xbf,0xef,0xfc,0x00,0x00,0x00,0x00,0x01,0xfe,0x0f,0xff,
  0xff,0xff,0xee,0x1f,0xff,0x9f,0xcf,0xfc,0x00,0x00,0x00,0x00,0x01,0xfd,0xf7,0xff,
  0xff,0xff,0xed,0xef,0xff,0xc0,0x1f,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0xfb,0xff,
  0xff,0xff,0xed,0xef,0xff,0xe0,0x3f,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0xfb,0xff,
  0xff,0xff,0xed,0xef,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfd,0xf7,0xff,
  0xff,0xff,0xe0,0x9f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfe,0x0f,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xef,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf8,0x03,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xfd,0xef,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfe,0x6f,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xef,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xaf,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xef,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xcf,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xfc,0x7b,0xff,
  0xff,0xff,0xff,0xbf,0xff,0xc2,0x1f,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0xbb,0xff,
  0xff,0xff,0xe0,0x0f,0xff,0x80,0x0f,0xfc,0x00,0x00,0x00,0x00,0x01,0xfb,0xdb,0xff,
  0xff,0xff,0xf7,0xbf,0xff,0xbd,0xef,0xfc,0x00,0x00,0x00,0x00,0x01,0xfb,0xeb,0xff,
  0xff,0xff,0xf9,0xbf,0xff,0xbd,0xef,0xfc,0x00,0x00,0x00,0x00,0x01,0xfc,0xf3,0xff,
  0xff,0xff,0xfe,0xbf,0xff,0xbf,0xef,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0x3f,0xff,0x8f,0x8f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xcf,0x9f,0xfc,0x00,0x00,0x00,0x00,0x01,0xfb,0x87,0xff,
  0xff,0xff,0xf1,0x1f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0x7b,0xff,
  0xff,0xff,0xee,0xef,0xff,0xe0,0x3f,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0x7b,0xff,
  0xff,0xff,0xee,0xef,0xff,0xc0,0x1f,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0x7b,0xff,
  0xff,0xff,0xef,0xef,0xff,0x9f,0xcf,0xfc,0x00,0x00,0x00,0x00,0x01,0xf8,0x27,0xff,
  0xff,0xff,0xf3,0x9f,0xff,0xbf,0xef,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xbf,0xef,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0x9f,0xcf,0xfc,0x00,0x00,0x00,0x00,0x01,0xfc,0x47,0xff,
  0xff,0xff,0xff,0xff,0xff,0xc0,0x1f,0xff,0xff,0xff,0xff,0xff,0xff,0xfb,0xbb,0xff,
  0xff,0xff,0xff,0xff,0xff,0xe0,0x3f,0xfc,0x00,0x00,0x00,0x00,0x01,0xfb,0xbb,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xfb,0xfb,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0xe7,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xfc,0x7b,0xff,
  0xff,0xff,0xf1,0xef,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xfb,0xbb,0xff,
  0xff,0xff,0xee,0xef,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xfb,0xdb,0xff,
  0xff,0xff,0xef,0x6f,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xfb,0xeb,0xff,
  0xff,0xff,0xef,0xaf,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0xf3,0xff,
  0xff,0xff,0xf3,0xcf,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xe0,0x0f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf7,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf7,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x00,0x00,0x00,0x01,0xff,0xff,0xff,
  0xff,0xff,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfc,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf8,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf8,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf9,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf9,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfc,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfe,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0x13,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfc,0x11,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf8,0x98,0xff,0xff,0xff,0xff,0x80,0x7f,0xff,0xf0,0x00,0x3f,0xff,0xff,
  0xff,0xff,0xf9,0x9c,0xff,0xff,0xff,0xfe,0x00,0x1f,0xff,0xf0,0x00,0x3f,0xff,0xff,
  0xff,0xff,0xf9,0x9c,0xff,0xff,0xff,0xfc,0x00,0x0f,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf9,0x9c,0xff,0xff,0xff,0xf8,0x7f,0x87,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf9,0x9c,0xff,0xff,0xff,0xf9,0xff,0xc7,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfc,0x99,0xff,0xff,0xff,0xf9,0xff,0xe7,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfc,0x01,0xff,0xff,0xff,0xf8,0xff,0xc7,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0x07,0xff,0xff,0xff,0xf8,0x7f,0x87,0xff,0xff,0x80,0x3f,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x00,0x0f,0xff,0xff,0x80,0x3f,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfe,0x00,0x1f,0xff,0xff,0xbf,0xff,0xff,0xff,
  0xff,0xff,0x00,0x00,0xff,0xff,0xff,0xff,0x80,0x7f,0xff,0xff,0xdf,0xff,0xff,0xff,
  0xff,0xff,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xc0,0x3f,0xff,0xff,
  0xff,0xff,0x03,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x80,0x3f,0xff,0xff,
  0xff,0xff,0xe0,0x0f,0xff,0xff,0xff,0xf9,0xf0,0x3f,0xff,0xff,0xbf,0xff,0xff,0xff,
  0xff,0xff,0xfe,0x00,0xff,0xff,0xff,0xf9,0xe0,0x0f,0xff,0xff,0xdf,0xff,0xff,0xff,
  0xff,0xff,0xfe,0x00,0xff,0xff,0xff,0xf9,0xc0,0x0f,0xff,0xff,0x80,0x3f,0xff,0xff,
  0xff,0xff,0xe0,0x0f,0xff,0xff,0xff,0xf9,0xc7,0xc7,0xff,0xff,0x80,0x3f,0xff,0xff,
  0xff,0xff,0x03,0xff,0xff,0xff,0xff,0xf9,0xcf,0xe7,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0x00,0x00,0xff,0xff,0xff,0xf9,0xcf,0xe7,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0x00,0x00,0xff,0xff,0xff,0xf8,0x47,0xe7,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf8,0x07,0xc7,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf8,0x07,0x0f,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfe,0x7f,0xff,0xff,0xff,0xff,0x87,0x0f,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfe,0x7f,0xff,0xff,0xff,0xff,0xff,0x3f,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfe,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfe,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfe,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfe,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfe,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfe,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfe,0x03,0xff,0xff,0xff,
  0xff,0xff,0xfe,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf8,0x00,0x7f,0xff,0xff,
  0xff,0xff,0xfe,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf9,0xfe,0x7f,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf7,0xff,0xbf,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xe7,0xff,0xf7,0xff,0xbf,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xe7,0xff,0xf7,0xff,0xbf,0xff,0xff,
  0xff,0xff,0xfc,0x00,0xff,0xff,0xff,0xff,0xff,0xe7,0xff,0xf9,0xfe,0x7f,0xff,0xff,
  0xff,0xff,0xf8,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf8,0x00,0x7f,0xff,0xff,
  0xff,0xff,0xf8,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfe,0x03,0xff,0xff,0xff,
  0xff,0xff,0xf9,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf9,0xff,0xff,0xff,0xff,0xff,0x80,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfc,0xff,0xff,0xff,0xff,0xfe,0x00,0x1f,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfc,0x7f,0xff,0xff,0xff,0xfc,0x00,0x0f,0xff,0xf7,0xc0,0xff,0xff,0xff,
  0xff,0xff,0xf8,0x00,0xff,0xff,0xff,0xf8,0x7f,0x87,0xff,0xf7,0x00,0x7f,0xff,0xff,
  0xff,0xff,0xf8,0x00,0xff,0xff,0xff,0xf9,0xff,0xc7,0xff,0xf7,0x3f,0x3f,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf9,0xff,0xe7,0xff,0xf7,0x7f,0xbf,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf8,0xff,0xc7,0xff,0xf7,0xbf,0xbf,0xff,0xff,
  0xff,0xff,0xff,0x13,0xff,0xff,0xff,0xf8,0x7f,0x87,0xff,0xf0,0x1f,0x3f,0xff,0xff,
  0xff,0xff,0xfc,0x11,0xff,0xff,0xff,0xfc,0x00,0x0f,0xff,0xf0,0x1c,0x7f,0xff,0xff,
  0xff,0xff,0xf8,0x98,0xff,0xff,0xff,0xfe,0x00,0x1f,0xff,0xff,0xfc,0xff,0xff,0xff,
  0xff,0xff,0xf9,0x9c,0xff,0xff,0xff,0xff,0x80,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf9,0x9c,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf9,0x9c,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf9,0x9c,0xff,0xff,0xff,0xf9,0xf0,0x3f,0xff,0xfc,0x3f,0xbf,0xff,0xff,
  0xff,0xff,0xfc,0x99,0xff,0xff,0xff,0xf9,0xe0,0x0f,0xff,0xf8,0x1f,0xbf,0xff,0xff,
  0xff,0xff,0xfc,0x01,0xff,0xff,0xff,0xf9,0xc0,0x0f,0xff,0xf3,0xcf,0xbf,0xff,0xff,
  0xff,0xff,0xff,0x07,0xff,0xff,0xff,0xf9,0xc7,0xc7,0xff,0xf7,0xe7,0xbf,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf9,0xcf,0xe7,0xff,0xf7,0xf1,0xbf,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf9,0xcf,0xe7,0xff,0xf3,0xf8,0xbf,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf8,0x47,0xe7,0xff,0xf8,0x7c,0x3f,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf8,0x07,0xc7,0xff,0xfc,0x7f,0x3f,0xff,0xff,
  0xff,0xff,0xf9,0xff,0xff,0xff,0xff,0xf8,0x07,0x0f,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf9,0xff,0xff,0xff,0xff,0xff,0x87,0x0f,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf9,0xff,0xff,0xff,0xff,0xff,0xff,0x3f,0xff,0xff,0xbf,0xbf,0xff,0xff,
  0xff,0xff,0xfc,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x9f,0x3f,0xff,0xff,
  0xff,0xff,0xfe,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0x86,0x3f,0xff,0xff,
  0xff,0xff,0xf8,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xe0,0x7f,0xff,0xff,
  0xff,0xff,0xf8,0x00,0xff,0xff,0xff,0xfe,0x0f,0xe7,0xff,0xff,0xf1,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x07,0xe7,0xff,0xff,0xe0,0x7f,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf8,0x03,0xe7,0xff,0xff,0x86,0x3f,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf8,0xf1,0xe7,0xff,0xff,0x9f,0x3f,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf9,0xf8,0xe7,0xff,0xff,0xbf,0xbf,0xff,0xff,
  0xff,0xff,0xf8,0x00,0xff,0xff,0xff,0xf9,0xfc,0x67,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf8,0x00,0xff,0xff,0xff,0xf8,0xfe,0x27,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xf1,0xff,0xff,0xff,0xf8,0x1f,0x07,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xf9,0xff,0xff,0xff,0xfc,0x1f,0x87,0xff,0xfc,0x3f,0xbf,0xff,0xff,
  0xff,0xff,0xff,0xfc,0xff,0xff,0xff,0xff,0x1f,0xc7,0xff,0xf8,0x1f,0xbf,0xff,0xff,
  0xff,0xff,0xff,0xfc,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf3,0xcf,0xbf,0xff,0xff,
  0xff,0xff,0xff,0xf8,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf7,0xe7,0xbf,0xff,0xff,
  0xff,0xff,0xf8,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf7,0xf1,0xbf,0xff,0xff,
  0xff,0xff,0xf8,0x01,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf3,0xf8,0xbf,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf8,0x7c,0x3f,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x7f,0x3f,0xff,0xff,
  0xff,0xff,0xff,0xfe,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfe,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xfc,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xf8,0x89,0xff,0xff,0xff,0xf8,0xff,0xff,0xff,0xfc,0x3f,0xbf,0xff,0xff,
  0xff,0xff,0xf9,0xcc,0xff,0xff,0xff,0xf8,0x7f,0xff,0xff,0xf8,0x1f,0xbf,0xff,0xff,
  0xff,0xff,0xf9,0xcc,0xff,0xff,0xff,0xf9,0x7f,0xff,0xff,0xf3,0xcf,0xbf,0xff,0xff,
  0xff,0xff,0xf9,0xcc,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf7,0xe7,0xbf,0xff,0xff,
  0xff,0xff,0xf9,0xcc,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf7,0xf1,0xbf,0xff,0xff,
  0xff,0xff,0xfc,0xe0,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf3,0xf8,0xbf,0xff,0xff,
  0xff,0xff,0xfe,0xf1,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xf8,0x7c,0x3f,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xfc,0x7f,0x3f,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xc1,0x83,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0x80,0x01,0xff,0xff,0xff,0xf8,0x00,0x07,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0x1c,0x38,0xff,0xff,0xff,0xf8,0x00,0x07,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0x3e,0x7c,0xff,0xff,0xff,0xfc,0x00,0x07,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0x3e,0x7c,0xff,0xff,0xff,0xfe,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0x3e,0x7c,0xff,0xff,0xff,0xff,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0x3e,0x7c,0xff,0xff,0xff,0xff,0x7f,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0x3e,0x7c,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
  0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff
};
static void SPI_Delay(UINT8 xrate)
{
  ;
}
/*
static void send_2byte(UINT8 val) {
int i;
union map{
UINT16 B;
struct {
UINT8 L;
UINT8 H;
    };
  }D = {
.B = 0,
  };

for (i = 7; i >= 0; i--) {
if (val & (1 << i))
D.B |= (3 << (i *2));
  }

SPI_Write(D.H);
SPI_Write(D.L);
}
*/
static void SPI_Write(UINT8 value){                                                           
  UINT8 i;
  
  
  SPI_Delay(1);
  for(i = 0; i < 8; i++)
  {
    EPD_W21_CLK_0;
    SPI_Delay(2);
    
    if(value & 0x80)
      EPD_W21_MOSI_1;
    else
      EPD_W21_MOSI_0;		
    value = (value << 1); 	
    SPI_Delay(2);
    __NOP();
    __NOP();
    EPD_W21_CLK_1; 
    SPI_Delay(2);
  }
}



static void EPD_W21_WriteCMD(UINT8 command){
  
  SPI_Delay(1);
  EPD_W21_CS_0;                   
  EPD_W21_DC_0;		// command write
  SPI_Write(command);
  EPD_W21_CS_1;
}
static void EPD_W21_WriteDATA(UINT8 command)
{
  
  SPI_Delay(1);
  EPD_W21_CS_0;                   
  EPD_W21_DC_1;		// command write
  SPI_Write(command);
  EPD_W21_CS_1;
}
/*
static void EPD_W21_WriteDATA_led(UINT8 command)
{

SPI_Delay(1);
EPD_W21_CS_0;                   
EPD_W21_DC_1;		// command write
send_2byte(command);
EPD_W21_CS_1;
}
*/
/*
static UINT8 EPD_W21_ReadDATA(void)
{

UINT8 i,j; 

P2OUT &= ~BIT3; 
P2DIR &= ~BIT3; 

EPD_W21_CS_0; 
EPD_W21_DC_1;	 // command write 
j=0; 
SPI_Delay(2); 
for(i=0; i<8; i++) 
{ 
EPD_W21_CLK_0; 
SPI_Delay(20); 
j=(j<<1); 
if((P2IN &BIT3)==BIT3) 
j|=0x01; 
    else 
j&=0xfe;	
SPI_Delay(5); 

EPD_W21_CLK_1; 
SPI_Delay(5); 
  } 
EPD_W21_CS_1; 

P2DIR |=BIT3; 
return(j); 
}
*/
static void lcd_chkstatus(void)
{
  
#define WAIT_COUNT	10	//10s超时
  SetWathcDog();
  UINT8 i=WAIT_COUNT;
  
  smclk_timer_isr(FALSE, 0,0); 
  Delay_ms(30);
  while(!(isEPD_W21_BUSY) && (0 != i) ) //低表示忙
  {
    sys_wakeup_wait(200); 
    i--;
  }
  
  smclk_timer_isr(FALSE, 0,0); 
  if(i == 0)
    while(1);
  
}


void EPD_IC_Rst(void)
{
  EPD_W21_RST_1;
  Delay_ms(1);
  EPD_W21_RST_0;		// Module reset
  Delay_ms(1);
  EPD_W21_RST_1;
  Delay_ms(1);
}

void Ultrachip(UINT8 color)
{
  unsigned int i;		     
  for(i=0;i<15000;i++)	     
  {
    
    EPD_W21_WriteDATA(color);      
  }  
  
}




void display_lcd(file_id_t fd)
{
  
  unsigned int i,j;
  UINT8  *data = TEMP.BYTE64,*data_red = TEMP.BYTE64+28;
  for(j=0;j<300;j++)	
  {
    f_read(fd, (299-j) * 50 ,data, 25); 
    f_read(F_BMP_RED, (299-j) * 50 ,data_red, 25); 
    for(i=0;i<25;i++)
    {       
      data[i] &= (data_red[i]);          
      EPD_W21_WriteDATA(data[i]);      
    }
    
    f_read(fd, (299-j) * 50+25 ,data, 25); 
    f_read(F_BMP_RED, (299-j) * 50+25 ,data_red, 25); 
    for(i=25;i<50;i++)
    { 
      data[i-25] &= (data_red[i-25]);    
      EPD_W21_WriteDATA(data[i-25]);        
    }
  }
}

/*
void rend_tep(void)
{
//调用此函数前busy线必须为低
UINT8 temp;
EPD_W21_WriteCMD(0x41); 
EPD_W21_WriteDATA (0x00);		//selects Internal temperature sensor.
EPD_W21_WriteCMD(0x40);
lcd_chkstatus();
temp = EPD_W21_ReadDATA();		//1st parameter [D7:D0]
}
*/
void EPD_W21_Init(void){
  
  epd_spi_init();
  EPD_IC_Rst();
  
  EPD_W21_WriteCMD(0x06);         //boost soft start
  EPD_W21_WriteDATA (0x17);		//A
  EPD_W21_WriteDATA (0x17);		//B
  EPD_W21_WriteDATA (0x17);		//C       
  
  EPD_W21_WriteCMD(0x04);  
  lcd_chkstatus();
  
  EPD_W21_WriteCMD(0x00);
  EPD_W21_WriteDATA(0x1f);		// KW-BF   KWR-AF	BWROTP 0f	BWOTP 1f	
  
  EPD_W21_WriteCMD(0x61);			//????éè?¨
  EPD_W21_WriteDATA (0x01);		//400
  EPD_W21_WriteDATA (0x90);       	 
  EPD_W21_WriteDATA (0x01);		//300
  EPD_W21_WriteDATA (0x2c);
  Delay_ms(2);
  EPD_W21_WriteCMD(0X50);
  EPD_W21_WriteDATA(0x97);		//VBDF 17|D7 VBDW 97 VBDB 57		VBDF F7 VBDW 77 VBDB 37  VBDR B7
  
}


void screen_close(void)
{
  EPD_W21_WriteCMD(0X50);
  EPD_W21_WriteDATA(0xf7);
  /*
  EPD_W21_WriteCMD(0X82);  		//VCOM to 0V
  EPD_W21_WriteCMD(0X00);  		//
  SetWathcDog();
  Delay_ms(1000);	  	
  
  EPD_W21_WriteCMD(0x01);   		//VG&VS to 0V fast
  EPD_W21_WriteDATA (0x00);		
  EPD_W21_WriteDATA (0x00);		
  EPD_W21_WriteDATA (0x00);		      
  EPD_W21_WriteDATA (0x00);		
  EPD_W21_WriteDATA (0x00);
  SetWathcDog();
  Delay_ms(1000);
  */
  EPD_W21_WriteCMD(0X02);  	//power off
  lcd_chkstatus();
  EPD_W21_WriteCMD(0X07);  	//deep sleep
  EPD_W21_WriteDATA(0xA5);
  Delay_ms(100);
  close_epd();
}
BOOL screen_busy_fun(void)
{
#define TIMES_2S_BUSY 60                //2min
  if(epd_scn_tp.busy_times == TIMES_2S_BUSY)
  {
    while(1);
  }
  else if((isEPD_W21_BUSY))         //高不忙
  {
    epd_scn_tp.busy_times=0;
    epd_scn_tp.screen_busy_flag = FALSE;
    screen_close();
    return FALSE;
  }
  else
  {
    epd_scn_tp.screen_busy_flag = TRUE;
    return TRUE;
  }
}
void Init_EPD(void)
{
  open_epd(); 
  EPD_W21_Init();
  SetWathcDog(); 
  EPD_W21_WriteCMD(0x13);
  display_lcd(F_BMP_BW);   	
  EPD_W21_WriteCMD(0x12);        //display 
  
}

#endif


